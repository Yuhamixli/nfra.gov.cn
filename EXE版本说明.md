# NFRA金融监管爬虫 - EXE版本使用说明

## 🚀 快速开始

### 1. 运行程序
双击 `NFRA金融监管爬虫.exe` 即可启动程序

### 2. 首次使用建议
1. 选择 `7. WebDriver设置` → `2. 下载设置` 配置ChromeDriver
2. 选择 `4. 测试模式` 验证程序功能是否正常
3. 确认无误后选择相应的运行模式

## 📋 功能说明

### 主要功能
- **初始化模式（1）**：首次使用，下载2025年全部数据（2-4小时）
- **月度更新模式（2）**：获取上个月发布的新数据（10-20分钟）
- **每日更新模式（3）**：获取昨天发布的最新数据（2-5分钟）
- **测试模式（4）**：快速测试各功能，验证程序状态（5-10分钟）

### 高级功能
- **自定义爬取（5）**：灵活选择特定类别进行爬取
  - 总局机关：国家金融监督管理总局机关发布
  - 监管局本级：各地监管局本级发布
  - 监管分局本级：各地监管分局本级发布

### 管理功能
- **查看现有数据（6）**：显示已生成的文件列表
- **WebDriver设置（7）**：管理ChromeDriver配置
- **使用帮助（8）**：查看详细功能说明

## 📁 输出文件

### 文件位置
- **Excel文件**：`excel_output/` 目录
- **文本文件**：`text_output/` 目录
- **日志文件**：`logs/` 目录

### 主要文件
- `金融监管总局行政处罚信息_总表.xlsx` - 主总表文件
- `[模式名]_[类别]_[时间戳].xlsx` - 按模式生成的文件

## 🔧 技术特性

### EXE版本优势
- **有头模式**：显示浏览器窗口，可观察爬取过程
- **本地运行**：无需Python环境，双击即用
- **自包含**：包含所有必要依赖
- **本地存储**：所有文件存储在程序目录

### 性能优化
- **智能过滤**：精确定位目标数据，避免无效爬取
- **类别选择**：支持按类别爬取，大幅提升效率
- **断点续传**：支持中断后继续，避免重复工作
- **去重机制**：自动去除重复数据

## ⚠️ 使用注意事项

### 系统要求
- **操作系统**：Windows 10/11
- **浏览器**：Chrome浏览器（必须）
- **网络**：稳定的互联网连接
- **磁盘空间**：至少1GB可用空间

### 运行注意事项
1. **首次运行**：建议先使用测试模式验证功能
2. **浏览器窗口**：程序运行时会显示Chrome窗口，属正常现象
3. **运行时间**：初始化模式需要较长时间，请耐心等待
4. **网络中断**：如遇网络问题，可重新运行，程序支持断点续传
5. **杀毒软件**：部分杀毒软件可能误报，请添加到白名单

### ChromeDriver管理
- 程序优先使用本地`drivers/`目录中的ChromeDriver
- 如本地没有，会自动下载并缓存
- 可通过WebDriver设置菜单手动管理

## 🔍 故障排除

### 常见问题

#### 1. 程序无法启动
- **检查Chrome浏览器**：确保已安装Chrome浏览器
- **检查权限**：确保程序有读写权限
- **重新下载**：重新下载exe文件

#### 2. WebDriver错误
- 选择 `7. WebDriver设置` → `2. 下载设置`
- 或手动下载ChromeDriver放入`drivers/`目录

#### 3. 网络超时
- 检查网络连接
- 重新运行程序（支持断点续传）
- 如持续出现，可尝试测试模式

#### 4. 文件无法保存
- 检查磁盘可用空间
- 确保Excel文件未被其他程序打开
- 检查程序目录写入权限

#### 5. 数据为空
- 检查目标时间段是否有数据发布
- 尝试扩大时间范围
- 使用测试模式验证程序功能

## 📞 技术支持

### 获取帮助
1. 查看程序内置帮助（选项8）
2. 阅读完整版README.md文档
3. 检查`logs/`目录中的日志文件

### 性能建议
- **日常使用**：推荐使用月度更新模式
- **快速验证**：使用测试模式
- **特定需求**：使用自定义爬取功能
- **大量数据**：使用初始化模式（仅首次）

## 📈 版本信息

- **当前版本**：v2.3.1 EXE版
- **更新时间**：2025-01-03
- **主要特性**：本地ChromeDriver缓存、有头模式、智能类别选择
- **兼容性**：Windows 10/11，Chrome浏览器

---

*感谢使用NFRA金融监管爬虫！如有问题请参考日志文件或联系技术支持。* 